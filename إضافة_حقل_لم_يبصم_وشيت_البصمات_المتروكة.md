# ✅ إضافة حقل "لم يبصم" وشيت البصمات المتروكة

## التغييرات المنفذة

### 1. إضافة عمود "لم يبصم" في جدول النتائج المجمعة

**الملف**: `reports_widget.py`

#### التغييرات:
- **زيادة عدد الأعمدة**: من 11 إلى 12 عمود
- **إضافة عمود "لم يبصم"**: بين "البصمات المطلوبة" و "نسبة الالتزام %"
- **عرض القيمة**: يتم عرض قيمة `Missing Checks` في العمود الجديد

#### الأعمدة الجديدة:
```python
[
    "اسم الموظف", 
    "القسم", 
    "عدد أيام الدوام", 
    "الأيام المستوفية", 
    "أيام النقص", 
    "أيام الغياب", 
    "عدد مرات التأخير", 
    "مجموع دقائق التأخير",
    "البصمات الفعلية",
    "البصمات المطلوبة",
    "لم يبصم",  # ← عمود جديد
    "نسبة الالتزام %",
    "الحالة النهائية"
]
```

### 2. إضافة شيت "البصمات المتروكة" في التقرير المصدر

**الملف**: `report_generator.py`

#### الدالة الجديدة: `_write_missing_punches_sheet`
- **الوظيفة**: إنشاء شيت جديد يظهر جميع البصمات المتروكة
- **الترتيب**: مفروز حسب اسم الموظف، ثم التاريخ، ثم الوقت المطلوب
- **الأعمدة**:
  - اسم الموظف
  - القسم
  - التاريخ
  - الوقت المطلوب
  - الوصف (مثل: بداية الدوام، نهاية الصباح، إلخ)
  - نافذة التسامح
  - الحالة (لم يبصم)

#### ترتيب الأوراق في التقرير:
1. **ملخص الموظفين**: النتائج المجمعة لكل موظف
2. **تفاصيل الحضور اليومي**: التفاصيل اليومية
3. **البصمات المتروكة**: ← **شيت جديد** (مفروز حسب الأسماء)
4. **تحليل التأخير**: تحليل التأخيرات
5. **سجل مطابقة البصمات**: سجل كامل للمطابقة

## مثال على البيانات

### في جدول النتائج المجمعة:
| اسم الموظف | القسم | ... | البصمات المطلوبة | **لم يبصم** | نسبة الالتزام % |
|------------|-------|-----|------------------|-------------|------------------|
| ابراهيم محجوب | الوجبة الرابعة | ... | 18 | **10** | 44.44% |

### في شيت "البصمات المتروكة":
| اسم الموظف | القسم | التاريخ | الوقت المطلوب | الوصف | نافذة التسامح | الحالة |
|------------|-------|---------|---------------|-------|---------------|--------|
| ابراهيم محجوب | الوجبة الرابعة | 2025-12-24 | 08:00 | بداية الدوام | 07:30 - 08:30 | لم يبصم |
| ابراهيم محجوب | الوجبة الرابعة | 2025-12-24 | 12:00 | نهاية الصباح | 11:30 - 12:30 | لم يبصم |
| ... | ... | ... | ... | ... | ... | ... |

## المميزات

### 1. عرض واضح للبصمات المتروكة
- ✅ عمود منفصل في الجدول الرئيسي
- ✅ شيت كامل مفروز حسب الأسماء
- ✅ معلومات مفصلة عن كل بصمة متروكة

### 2. الترتيب الذكي
- ✅ مفروز حسب اسم الموظف (ألفبائياً)
- ✅ ثم حسب التاريخ (من الأقدم للأحدث)
- ✅ ثم حسب الوقت المطلوب

### 3. معلومات شاملة
- ✅ اسم الموظف والقسم
- ✅ التاريخ والوقت المطلوب
- ✅ وصف الوقت المطلوب (بداية الدوام، نهاية الصباح، إلخ)
- ✅ نافذة التسامح
- ✅ الحالة (لم يبصم)

## الاستخدام

### في الواجهة:
1. بعد حساب الحضور، سيظهر عمود "لم يبصم" في جدول النتائج المجمعة
2. يمكن تصدير التقرير للحصول على شيت "البصمات المتروكة"

### في التقرير المصدر:
1. افتح ملف Excel المصدر
2. انتقل إلى شيت "البصمات المتروكة"
3. ستجد جميع البصمات المتروكة مفروزة حسب الأسماء

## النتيجة

✅ **حقل "لم يبصم"** يظهر في جدول النتائج المجمعة
✅ **شيت "البصمات المتروكة"** يظهر في التقرير المصدر
✅ **مفروز حسب الأسماء** كما طلب المستخدم
✅ **معلومات شاملة** عن كل بصمة متروكة

